<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PUP EIS Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="assets/css/style.css">
  <script src="assets/js/tailwind.config.js"></script>
</head>

<body class="min-h-screen bg-gray-200 text-gray-800 font-[Poppins]">
  <nav class="header-navbar w-full bg-[#991b1b] flex items-center justify-between px-6 py-3 z-[100] relative">
    <div class="flex items-center gap-4">
      <div class="flex items-center gap-2">
        <img src="assets/PUPlogo.png" alt="PUP Logo" class="pup-logo-img">
      </div>
      <div class="text-column">
        <div class="title"> PUP TAGUIG ONE PORTAL</div>
        <div class="subtitle">POLYTECHNIC UNIVERSITY OF THE PHILIPPINES — TAGUIG CAMPUS</div>
      </div>
    </div>
    <div class="relative">
      <button class="profile-btn">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="currentColor">
          <path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Zm0 
          1.5c-4 0-7.5 1.79-7.5 4v1.5A1.5 1.5 0 0 0 6 21h12a1.5 
          1.5 0 0 0 1.5-1.5V17.5c0-2.21-3.5-4-7.5-4Z"/>
        </svg>
      </button>
      <div id="profile-dropdown" class="absolute right-0 mt-2 w-32 bg-white text-black rounded shadow hidden">
        <form>
          <button type="submit" class="w-full text-left px-4 py-2 hover:bg-gray-100">Logout</button>
          <button type="submit" class="w-full text-left px-4 py-2 hover:bg-gray-100">Exit Profile</button>
        </form>
      </div>
    </div>
  </nav>

  <main class="p-6">
    <div class="max-w-4xl mx-auto">
        <!-- Page Title -->
        <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-800">User Profile Information</h1>
        <p class="text-gray-600 mt-2">View and manage your account details</p>
        </div>

        <!-- Profile Card -->
        <div class="bg-white rounded-2xl shadow-lg overflow-hidden">
        <!-- Profile Header with Background -->
        <div class="bg-gradient-to-r from-red-800 to-red-600 p-6 text-white">
            <div class="flex flex-col md:flex-row items-center gap-6">
            <!-- Profile Picture -->
            <div class="relative">
                <div class="w-32 h-32 rounded-full border-4 border-white/30 overflow-hidden bg-white">
                <img 
                    src="assets/profile-pic.jpg" 
                    alt="Profile Picture" 
                    class="w-full h-full object-cover"
                    onerror="this.src='https://via.placeholder.com/128/991b1b/FFFFFF?text=PUPT'"
                >
                </div>
            </div>
            
            <!-- Name and Basic Info -->
            <div class="flex-1 text-center md:text-left">
                <h2 class="text-2xl font-bold" id="fullNameDisplay">Juan Miguel Dela Cruz Santos</h2>
                <p class="text-white/90 mt-1" id="usernameDisplay">@juan.delacruz</p>
                <div class="flex flex-wrap items-center justify-center md:justify-start gap-4 mt-4">
                <div class="badge badge-lg bg-white/20 border-0 text-white px-4 py-2" id="statusBadge">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Active
                </div>
                <div class="badge badge-lg bg-white/20 border-0 text-white px-4 py-2" id="roleBadge">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                    </svg>
                    Student
                </div>
                </div>
            </div>
            </div>
        </div>

        <!-- Profile Details -->
        <div class="p-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Student ID (Derived from ID field) -->
            <div class="space-y-2">
                <label class="text-sm font-semibold text-gray-500 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2" />
                </svg>
                Student ID
                </label>
                <div class="input input-bordered w-full bg-gray-50 flex items-center">
                <span class="font-mono text-sm text-red-800" id="studentIdDisplay">2023-1234-TG-0</span>
                </div>
            </div>

            <!-- Username -->
            <div class="space-y-2">
                <label class="text-sm font-semibold text-gray-500 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                Username
                </label>
                <div class="input input-bordered w-full bg-gray-50 flex items-center">
                <span class="text-gray-800" id="usernameValue">juan.delacruz</span>
                </div>
            </div>

            <!-- First Name -->
            <div class="space-y-2">
                <label class="text-sm font-semibold text-gray-500 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                First Name
                </label>
                <div class="input input-bordered w-full bg-gray-50 flex items-center">
                <span class="text-gray-800" id="firstName">Juan</span>
                </div>
            </div>

            <!-- Middle Name -->
            <div class="space-y-2">
                <label class="text-sm font-semibold text-gray-500 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                Middle Name
                </label>
                <div class="input input-bordered w-full bg-gray-50 flex items-center">
                <span class="text-gray-800" id="middleName">Miguel</span>
                </div>
            </div>

            <!-- Last Name -->
            <div class="space-y-2">
                <label class="text-sm font-semibold text-gray-500 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                </svg>
                Last Name
                </label>
                <div class="input input-bordered w-full bg-gray-50 flex items-center">
                <span class="text-gray-800" id="lastName">Dela Cruz Santos</span>
                </div>
            </div>

            <!-- Email -->
            <div class="space-y-2">
                <label class="text-sm font-semibold text-gray-500 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
                Email Address
                </label>
                <div class="input input-bordered w-full bg-gray-50 flex items-center">
                <span class="text-gray-800" id="emailValue">juan.delacruz@iskolarngbayan.pup.edu.ph</span>
                </div>
            </div>

            <!-- Status -->
            <div class="space-y-2">
                <label class="text-sm font-semibold text-gray-500 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                Account Status
                </label>
                <div class="input input-bordered w-full bg-gray-50 flex items-center">
                <span class="text-gray-800 capitalize" id="statusValue">active</span>
                </div>
            </div>

            <!-- Role (Assuming additional field) -->
            <div class="space-y-2">
                <label class="text-sm font-semibold text-gray-500 flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                </svg>
                User Role
                </label>
                <div class="input input-bordered w-full bg-gray-50 flex items-center">
                <span class="text-gray-800" id="roleValue">Student</span>
                </div>
            </div>

            <!-- Timestamps Section -->
            <div class="md:col-span-2 mt-6 pt-6 border-t">
                <h3 class="text-lg font-semibold text-gray-700 mb-4">Audit Information</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="card bg-base-100 shadow-sm">
                    <div class="card-body p-4">
                    <h4 class="card-title text-sm text-gray-500">Created At</h4>
                    <p class="text-gray-800 font-medium" id="createdAt">2023-08-15 10:30:45</p>
                    </div>
                </div>
                <div class="card bg-base-100 shadow-sm">
                    <div class="card-body p-4">
                    <h4 class="card-title text-sm text-gray-500">Updated At</h4>
                    <p class="text-gray-800 font-medium" id="updatedAt">2024-01-20 14:25:10</p>
                    </div>
                </div>
                <div class="card bg-base-100 shadow-sm">
                    <div class="card-body p-4">
                    <h4 class="card-title text-sm text-gray-500">Deleted At</h4>
                    <p class="text-gray-800 font-medium" id="deletedAt">-</p>
                    </div>
                </div>
                </div>
            </div>

            <!-- Email Status Section -->
            <div class="md:col-span-2 mt-6">
                <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4 p-4 rounded-lg bg-gray-50 border">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                    </div>
                    <div>
                    <h4 class="font-semibold text-gray-800">Email Status</h4>
                    <p class="text-sm text-gray-600">Current email delivery status</p>
                    </div>
                </div>
                <div class="flex-1"></div>
                <div class="flex items-center gap-2 px-4 py-2 rounded-lg bg-green-50 border border-green-200">
                    <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                    <span class="text-green-700 font-medium flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                    Email Active
                    </span>
                </div>
                </div>
            </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-wrap justify-end gap-4 mt-8 pt-6 border-t">
            <button class="btn btn-outline text-[#991b1b] border-[#991b1b] hover:bg-pup-yellow hover:border-pup-yellow hover:text-[#991b1b]">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                </svg>
                Edit Profile
            </button>
            <button class="btn bg-[#991b1b] text-white border-[#991b1b] hover:bg-pup-yellow hover:border-pup-yellow hover:text-[#991b1b]">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                </svg>
                Change Password
            </button>
            </div>
        </div>
        </div>

        <!-- Audit Logs Section -->
        <div class="mt-8 bg-white rounded-2xl shadow-lg overflow-hidden">
        <div class="p-6 border-b">
            <h3 class="text-xl font-bold text-gray-800">Audit Logs</h3>
            <p class="text-gray-600 mt-1">Recent account activities and changes</p>
        </div>
        <div class="p-6">
            <div class="overflow-x-auto">
            <table class="table w-full">
                <thead>
                <tr class="bg-gray-50">
                    <th class="font-semibold text-gray-700">Timestamp</th>
                    <th class="font-semibold text-gray-700">Action</th>
                    <th class="font-semibold text-gray-700">Details</th>
                </tr>
                </thead>
                <tbody>
                <tr class="hover:bg-gray-50">
                    <td class="font-mono text-sm">2024-01-20 14:25:10</td>
                    <td>
                    <span class="badge badge-sm bg-blue-100 text-blue-800 border-0">PROFILE_UPDATE</span>
                    </td>
                    <td>Updated email address</td>
                </tr>
                <tr class="hover:bg-gray-50">
                    <td class="font-mono text-sm">2024-01-18 09:15:22</td>
                    <td>
                    <span class="badge badge-sm bg-green-100 text-green-800 border-0">LOGIN_SUCCESS</span>
                    </td>
                    <td>Successful login</td>
                </tr>
                <tr class="hover:bg-gray-50">
                    <td class="font-mono text-sm">2024-01-15 16:45:33</td>
                    <td>
                    <span class="badge badge-sm bg-yellow-100 text-yellow-800 border-0">PASSWORD_CHANGE</span>
                    </td>
                    <td>Password changed</td>
                </tr>
                <tr class="hover:bg-gray-50">
                    <td class="font-mono text-sm">2024-01-10 11:20:45</td>
                    <td>
                    <span class="badge badge-sm bg-purple-100 text-purple-800 border-0">ROLE_ASSIGNED</span>
                    </td>
                    <td>Assigned student role</td>
                </tr>
                <tr class="hover:bg-gray-50">
                    <td class="font-mono text-sm">2023-08-15 10:30:45</td>
                    <td>
                    <span class="badge badge-sm bg-gray-100 text-gray-800 border-0">ACCOUNT_CREATED</span>
                    </td>
                    <td>Account created</td>
                </tr>
                </tbody>
            </table>
            </div>
            <div class="mt-4 text-center">
            <button class="btn btn-sm btn-outline text-[#991b1b] border-[#991b1b] hover:bg-pup-yellow hover:border-pup-yellow hover:text-[#991b1b]">
                View All Logs
            </button>
            </div>
        </div>
        </div>
    </div>
    </main>

  <br><br>

  <footer class="relative bg-[#991b1b] text-white px-12 py-12 overflow-hidden">

        <!-- MAIN CONTAINER -->
        <div class="relative z-10 max-w-6xl mx-auto flex flex-col md:flex-row justify-between gap-10">

            <!-- LEFT SIDE -->
            <div class="flex-1 md:max-w-[100%]">
                <h2 class="text-2xl font-bold m-0">PUPT ONE PORTAL 2025</h2>
                <p class="text-yellow-300 font-semibold mt-1 mb-4">One Portal System</p>

                <p class="max-w-[600px] text-sm leading-relaxed mb-6">
                    Polytechnic University of the Philippines Taguig One Portal System (PUPT One Portal) — 
                    a centralized system that provides students, faculty, and staff with seamless access to various services 
                    and resources offered by the campus. It aims to enhance the overall user experience by integrating multiple services.
                </p>

                <p class="text-sm text-gray-100">
                    © 2025 <span class="font-semibold text-white">Polytechnic University of the Philippines</span><br>
                    All rights reserved. PUPT One Portal Management System
                </p>
            </div>

            <!-- RIGHT SIDE -->
            <div class="flex-1 md:max-w-[100%] md:text-right">
                <h3 class="font-semibold mb-4 text-lg">Stay Connected</h3>

                <div class="flex md:justify-end gap-3 mb-2">
                    <a href="#" class="bg-white/10 hover:bg-white/25 transition p-2 rounded-lg flex items-center justify-center">
                        <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg"
                            class="w-5 h-5 invert" alt="Facebook">
                    </a>

                    <a href="#" class="bg-white/10 hover:bg-white/25 transition p-2 rounded-lg flex items-center justify-center">
                        <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/maildotru.svg"
                            class="w-5 h-5 invert" alt="Email">
                    </a>
                </div>

                <p class="text-sm">Follow us for updates</p>
            </div>

        </div>

        <!-- LINKS UNDER -->
        <div class="relative z-10 text-center mt-10 space-x-3 text-sm">
            <a href="#" class="hover:text-yellow-300 transition">Privacy Policy</a>
            <span class="opacity-70">•</span>
            <a href="#" class="hover:text-yellow-300 transition">Terms of Service</a>
            <span class="opacity-70">•</span>
            <a href="#" class="hover:text-yellow-300 transition">Feedback</a>
        </div>

    </footer>

    <!-- Edit Profile Modal -->
    <dialog id="editProfileModal" class="modal">
    <div class="modal-box max-w-4xl max-h-[90vh] p-0 overflow-hidden flex flex-col">
        <!-- Modal Header -->
        <div class="bg-gradient-to-r from-red-800 to-red-600 p-6 text-white shrink-0">
        <div class="flex items-center justify-between">
            <div>
            <h3 class="text-2xl font-bold">Edit Profile</h3>
            <p class="text-white/90 mt-1">Update your personal information</p>
            </div>
            <button class="btn btn-sm btn-circle btn-ghost text-white hover:bg-white/20" onclick="editProfileModal.close()">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
            </button>
        </div>
        </div>

        <!-- Modal Form - Scrollable Content -->
        <div class="flex-1 overflow-y-auto p-6">
        <form id="editProfileForm" class="space-y-6">
            <!-- Profile Picture Upload -->
            <div class="flex flex-col items-center mb-6">
            <div class="relative mb-4">
                <div class="w-32 h-32 rounded-full border-4 border-red-100 overflow-hidden bg-white shadow-lg">
                <img 
                    id="profilePreview" 
                    src="assets/profile-pic.jpg" 
                    alt="Profile Picture" 
                    class="w-full h-full object-cover"
                    onerror="this.src='https://via.placeholder.com/128/991b1b/FFFFFF?text=PUPT'"
                >
                </div>
                <label for="profilePicture" class="absolute bottom-0 right-0 bg-[#991b1b] text-white p-2 rounded-full cursor-pointer hover:bg-red-700 transition">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                </label>
                <input 
                type="file" 
                id="profilePicture" 
                name="profilePicture" 
                accept="image/*" 
                class="hidden" 
                onchange="previewProfileImage(event)"
                >
            </div>
            <p class="text-sm text-gray-500">Click the camera icon to change profile picture</p>
            </div>

            <!-- Personal Information -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <!-- First Name -->
            <div class="space-y-2">
                <label class="block text-sm font-semibold text-gray-700">
                First Name <span class="text-red-500">*</span>
                </label>
                <input 
                type="text" 
                id="editFirstName" 
                name="firstName" 
                class="input input-bordered w-full" 
                placeholder="Enter first name" 
                required
                maxlength="50"
                >
                <p class="text-xs text-gray-500">Max 50 characters</p>
            </div>

            <!-- Middle Name -->
            <div class="space-y-2">
                <label class="block text-sm font-semibold text-gray-700">
                Middle Name
                </label>
                <input 
                type="text" 
                id="editMiddleName" 
                name="middleName" 
                class="input input-bordered w-full" 
                placeholder="Enter middle name" 
                maxlength="50"
                >
                <p class="text-xs text-gray-500">Optional</p>
            </div>

            <!-- Last Name -->
            <div class="space-y-2">
                <label class="block text-sm font-semibold text-gray-700">
                Last Name <span class="text-red-500">*</span>
                </label>
                <input 
                type="text" 
                id="editLastName" 
                name="lastName" 
                class="input input-bordered w-full" 
                placeholder="Enter last name" 
                required
                maxlength="50"
                >
                <p class="text-xs text-gray-500">Max 50 characters</p>
            </div>
            </div>

            <!-- Username -->
            <div class="space-y-2">
            <label class="block text-sm font-semibold text-gray-700">
                Username <span class="text-red-500">*</span>
            </label>
            <input 
                type="text" 
                id="editUsername" 
                name="username" 
                class="input input-bordered w-full" 
                placeholder="Enter username" 
                required
                maxlength="255"
            >
            <p class="text-xs text-gray-500">Must be unique</p>
            </div>

            <!-- Validation Errors -->
            <div id="formErrors" class="hidden p-4 bg-red-50 border border-red-200 rounded-lg">
            <div class="flex items-start gap-2 text-red-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <div>
                <p class="font-medium">Please fix the following errors:</p>
                <ul class="list-disc list-inside text-sm mt-1" id="errorList"></ul>
                </div>
            </div>
            </div>

            <!-- Success Message -->
            <div id="successMessage" class="hidden p-4 bg-green-50 border border-green-200 rounded-lg">
            <div class="flex items-center gap-2 text-green-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 01118 0z" />
                </svg>
                <span class="font-medium">Profile updated successfully!</span>
            </div>
            </div>
        </form>
        </div>

        <!-- Modal Footer - Fixed at Bottom -->
        <div class="modal-action p-6 bg-gray-50 border-t shrink-0">
        <div class="flex flex-col sm:flex-row justify-between items-center w-full gap-4">
            <div class="text-sm text-gray-500">
            Fields marked with <span class="text-red-500">*</span> are required
            </div>
            <div class="flex flex-wrap gap-3">
            <button 
                type="button" 
                class="btn btn-outline text-[#991b1b] border-[#991b1b] hover:bg-pup-yellow hover:border-pup-yellow hover:text-[#991b1b]" 
                onclick="editProfileModal.close()"
            >
                Cancel
            </button>
            <button 
                type="button" 
                class="btn bg-[#991b1b] text-white border-[#991b1b] hover:bg-pup-yellow hover:border-pup-yellow hover:text-[#991b1b]" 
                onclick="saveProfileChanges()"
            >
                Save Changes
            </button>
            </div>
        </div>
        </div>
    </div>
    
    <!-- DaisyUI modal backdrop -->
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
    </dialog>

    <!-- Change Password Modal -->
    <dialog id="changePasswordModal" class="modal">
    <div class="modal-box max-w-md p-0">
        
        <!-- Step 1: Password Form -->
        <div id="passwordStep">
        <!-- Modal Header -->
        <div class="bg-gradient-to-r from-red-800 to-red-600 p-6 text-white">
            <div class="flex items-center justify-between">
            <div>
                <h3 class="text-2xl font-bold">Change Password</h3>
                <p class="text-white/90 mt-1">Secure your account with a new password</p>
            </div>
            <button type="button" class="btn btn-sm btn-circle btn-ghost text-white hover:bg-white/20" onclick="changePasswordModal.close()">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            </div>
        </div>

        <!-- Modal Content -->
        <div class="p-6">
            <form id="changePasswordForm" class="space-y-4">
            <!-- Current Password -->
            <div class="space-y-2">
                <label class="block text-sm font-semibold text-gray-700">
                Current Password <span class="text-red-500">*</span>
                </label>
                <div class="relative">
                <input 
                    type="password" 
                    id="currentPassword" 
                    name="currentPassword" 
                    class="input input-bordered w-full pr-10" 
                    placeholder="Enter current password" 
                    required
                >
                <button type="button" class="absolute right-3 top-3 text-gray-500 hover:text-gray-700" onclick="togglePasswordVisibility('currentPassword')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                </button>
                </div>
            </div>

            <!-- New Password -->
            <div class="space-y-2">
                <label class="block text-sm font-semibold text-gray-700">
                New Password <span class="text-red-500">*</span>
                </label>
                <div class="relative">
                <input 
                    type="password" 
                    id="newPassword" 
                    name="newPassword" 
                    class="input input-bordered w-full pr-10" 
                    placeholder="Enter new password" 
                    required
                    minlength="8"
                >
                <button type="button" class="absolute right-3 top-3 text-gray-500 hover:text-gray-700" onclick="togglePasswordVisibility('newPassword')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                </button>
                </div>
                <div class="text-xs text-gray-500 space-y-1 mt-2">
                <p class="flex items-center gap-1">
                    <span id="lengthCheck" class="text-gray-400">✓</span> At least 8 characters
                </p>
                <p class="flex items-center gap-1">
                    <span id="uppercaseCheck" class="text-gray-400">✓</span> One uppercase letter
                </p>
                <p class="flex items-center gap-1">
                    <span id="numberCheck" class="text-gray-400">✓</span> One number
                </p>
                <p class="flex items-center gap-1">
                    <span id="specialCheck" class="text-gray-400">✓</span> One special character
                </p>
                </div>
            </div>

            <!-- Confirm Password -->
            <div class="space-y-2">
                <label class="block text-sm font-semibold text-gray-700">
                Confirm New Password <span class="text-red-500">*</span>
                </label>
                <div class="relative">
                <input 
                    type="password" 
                    id="confirmPassword" 
                    name="confirmPassword" 
                    class="input input-bordered w-full pr-10" 
                    placeholder="Confirm new password" 
                    required
                >
                <button type="button" class="absolute right-3 top-3 text-gray-500 hover:text-gray-700" onclick="togglePasswordVisibility('confirmPassword')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                    </svg>
                </button>
                </div>
            </div>

            <!-- Password Mismatch Error -->
            <div id="passwordMismatchError" class="hidden p-3 bg-red-50 border border-red-200 rounded-lg">
                <div class="flex items-center gap-2 text-red-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span class="text-sm">New passwords do not match</span>
                </div>
            </div>

            <!-- Password Validation Error -->
            <div id="passwordValidationError" class="hidden p-3 bg-red-50 border border-red-200 rounded-lg">
                <div class="flex items-center gap-2 text-red-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span class="text-sm" id="validationErrorMessage">Password does not meet requirements</span>
                </div>
            </div>
            </form>
        </div>

        <!-- Modal Footer -->
        <div class="modal-action p-4 bg-gray-50 border-t">
            <div class="flex flex-col sm:flex-row justify-between items-center w-full gap-3">
            <div class="text-sm text-gray-500">
                <span class="text-red-500">*</span> Required fields
            </div>
            <div class="flex gap-2">
                <button 
                type="button" 
                class="btn btn-outline text-[#991b1b] border-[#991b1b] hover:bg-pup-yellow hover:border-pup-yellow hover:text-[#991b1b]" 
                onclick="changePasswordModal.close()"
                >
                Cancel
                </button>
                <button 
                type="button" 
                class="btn bg-[#991b1b] text-white border-[#991b1b] hover:bg-pup-yellow hover:border-pup-yellow hover:text-[#991b1b]" 
                onclick="validatePasswordForm()"
                >
                Continue
                </button>
            </div>
            </div>
        </div>
        </div>

        <!-- Step 2: OTP Verification -->
        <div id="otpStep" class="hidden">
        <!-- Modal Header -->
        <div class="bg-gradient-to-r from-red-800 to-red-600 p-6 text-white">
            <div class="flex items-center justify-between">
            <div>
                <h3 class="text-2xl font-bold">Verify Identity</h3>
                <p class="text-white/90 mt-1">Enter the OTP sent to your email</p>
            </div>
            <button type="button" class="btn btn-sm btn-circle btn-ghost text-white hover:bg-white/20" onclick="changePasswordModal.close()">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
            </div>
        </div>

        <!-- OTP Content -->
        <div class="p-6">
            <div class="text-center mb-6">
            <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                </svg>
            </div>
            <h4 class="text-lg font-semibold text-gray-800">Check Your Email</h4>
            <p class="text-gray-600 mt-2">
                We've sent a 6-digit verification code to
                <span class="font-medium text-[#991b1b] block mt-1" id="otpEmailDisplay">juan.delacruz@iskolarngbayan.pup.edu.ph</span>
            </p>
            <p class="text-sm text-gray-500 mt-2">The code will expire in 10 minutes</p>
            </div>

            <!-- OTP Input -->
            <div class="space-y-4">
            <div class="text-center">
                <div class="flex justify-center gap-2 mb-4" id="otpInputs">
                <!-- OTP inputs will be generated here -->
                </div>
                <p class="text-sm text-gray-500">Enter the 6-digit code</p>
            </div>

            <!-- OTP Error -->
            <div id="otpError" class="hidden p-3 bg-red-50 border border-red-200 rounded-lg">
                <div class="flex items-center gap-2 text-red-700">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span class="text-sm" id="otpErrorMessage">Invalid OTP code</span>
                </div>
            </div>

            <!-- Resend OTP -->
            <div class="text-center">
                <p class="text-sm text-gray-600">Didn't receive the code?</p>
                <button 
                type="button" 
                class="text-sm text-[#991b1b] font-medium hover:text-red-700 mt-1"
                onclick="resendOTP()"
                id="resendBtn"
                >
                Resend OTP
                </button>
                <p class="text-xs text-gray-500 mt-2" id="resendTimer">Resend available in <span id="countdown">01:00</span></p>
            </div>
            </div>
        </div>

        <!-- OTP Footer -->
        <div class="modal-action p-4 bg-gray-50 border-t">
            <div class="flex flex-col sm:flex-row justify-between items-center w-full gap-3">
            <button 
                type="button" 
                class="btn btn-outline text-[#991b1b] border-[#991b1b] hover:bg-pup-yellow hover:border-pup-yellow hover:text-[#991b1b]" 
                onclick="goToPasswordStep()"
            >
                Back
            </button>
            <div class="flex gap-2">
                <button 
                type="button" 
                class="btn bg-[#991b1b] text-white border-[#991b1b] hover:bg-pup-yellow hover:border-pup-yellow hover:text-[#991b1b]" 
                onclick="verifyOTP()"
                >
                Verify & Change Password
                </button>
            </div>
            </div>
        </div>
        </div>

        <!-- Step 3: Success -->
        <div id="successStep" class="hidden">
        <!-- Modal Header -->
        <div class="bg-gradient-to-r from-green-600 to-green-500 p-6 text-white">
            <div class="flex items-center justify-between">
            <div>
                <h3 class="text-2xl font-bold">Success!</h3>
                <p class="text-white/90 mt-1">Password changed successfully</p>
            </div>
            </div>
        </div>

        <!-- Success Content -->
        <div class="p-6">
            <div class="text-center">
            <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>
            <h4 class="text-xl font-bold text-gray-800 mb-2">Password Updated</h4>
            <p class="text-gray-600 mb-6">
                Your password has been changed successfully. You will be logged out automatically for security reasons.
            </p>
            
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <div class="flex items-start gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <div class="text-left">
                    <p class="text-sm text-blue-800">
                    <span class="font-semibold">Security Note:</span> For security purposes, you'll need to log in again with your new password on your next session.
                    </p>
                </div>
                </div>
            </div>

            <!-- Audit Log Update -->
            <div class="mt-6 pt-6 border-t">
                <h5 class="text-sm font-semibold text-gray-700 mb-3">Security Activity Logged</h5>
                <div class="bg-gray-50 rounded-lg p-4">
                <div class="flex items-center justify-between">
                    <div class="text-left">
                    <p class="text-sm font-medium text-gray-800">Password Change</p>
                    <p class="text-xs text-gray-500">Just now</p>
                    </div>
                    <span class="badge badge-sm bg-green-100 text-green-800 border-0">
                    Completed
                    </span>
                </div>
                </div>
            </div>
            </div>
        </div>

        <!-- Success Footer -->
        <div class="modal-action p-4 bg-gray-50 border-t">
            <div class="flex justify-center w-full">
            <button 
                type="button" 
                class="btn bg-[#991b1b] text-white border-[#991b1b] hover:bg-pup-yellow hover:border-pup-yellow hover:text-[#991b1b] px-8" 
                onclick="completePasswordChange()"
            >
                Close
            </button>
            </div>
        </div>
        </div>
    </div>
    
    <!-- DaisyUI modal backdrop -->
    <form method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
    </dialog>

   <script>
    document.addEventListener("DOMContentLoaded", () => {
        // -------------------------------
        // GENERIC DROPDOWN TOGGLER
        // -------------------------------
        function setupDropdown(buttonSelector, dropdownSelector) {
            const btn = document.querySelector(buttonSelector);
            const dropdown = document.querySelector(dropdownSelector);

            if (!btn || !dropdown) return; // safety check

            btn.addEventListener("click", (e) => {
                e.stopPropagation();
                dropdown.classList.toggle("hidden");
            });

            // Close when clicking outside
            document.addEventListener("click", () => {
                dropdown.classList.add("hidden");
            });
        }

        // -------------------------------
        // PROFILE DROPDOWN
        // -------------------------------
        setupDropdown(".profile-btn", "#profile-dropdown");

        // -------------------------------
        // LOGOUT BUTTON
        // -------------------------------
        const logoutBtn = document.querySelector("#profile-dropdown button:nth-child(1)");
        if (logoutBtn) {
            logoutBtn.addEventListener("click", (e) => {
                e.preventDefault();
                window.location.href = "index.html";
            });
        }

        // -------------------------------
        // PROFILE PAGE BUTTON
        // -------------------------------
        const profileBtn = document.querySelector("#profile-dropdown button:nth-child(2)");
        if (profileBtn) {
            profileBtn.addEventListener("click", (e) => {
                e.preventDefault();
                window.location.href = "dashboard_page1.html";
            });
        }

        // -------------------------------
        // EDIT PROFILE BUTTON
        // -------------------------------
        const editProfileBtn = document.querySelector('main button:first-child');
        if (editProfileBtn && editProfileBtn.textContent.includes('Edit Profile')) {
            editProfileBtn.onclick = openEditProfileModal;
        }

        // Initialize modal elements
        const editProfileModal = document.getElementById('editProfileModal');
        const formErrors = document.getElementById('formErrors');
        const successMessage = document.getElementById('successMessage');
        const errorList = document.getElementById('errorList');

        // Close modal when clicking outside
        if (editProfileModal) {
            editProfileModal.addEventListener('click', (event) => {
                if (event.target === editProfileModal) {
                    editProfileModal.close();
                }
            });
        }

        // Add animation styles
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fade-in {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            
            @keyframes fade-out {
                from { opacity: 1; transform: translateY(0); }
                to { opacity: 0; transform: translateY(10px); }
            }
            
            .animate-fade-in {
                animation: fade-in 0.3s ease-out;
            }
            
            .animate-fade-out {
                animation: fade-out 0.3s ease-in;
            }
        `;
        document.head.appendChild(style);
    });

    // Modal Functions
    function openEditProfileModal() {
        const editProfileModal = document.getElementById('editProfileModal');
        const formErrors = document.getElementById('formErrors');
        const successMessage = document.getElementById('successMessage');
        
        if (!editProfileModal) return;
        
        // Populate form fields with current profile data
        // Only populate fields that exist in the modal
        document.getElementById('editFirstName').value = document.getElementById('firstName').textContent.trim();
        document.getElementById('editMiddleName').value = document.getElementById('middleName').textContent.trim();
        document.getElementById('editLastName').value = document.getElementById('lastName').textContent.trim();
        document.getElementById('editUsername').value = document.getElementById('usernameValue').textContent.trim();
        
        // Note: Email was removed from the modal, so don't try to set it
        
        // Reset messages
        if (formErrors) formErrors.classList.add('hidden');
        if (successMessage) successMessage.classList.add('hidden');
        
        // Show modal
        editProfileModal.showModal();
    }

    function previewProfileImage(event) {
        const input = event.target;
        const preview = document.getElementById('profilePreview');
        
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                preview.src = e.target.result;
            };
            
            reader.readAsDataURL(input.files[0]);
        }
    }

    function validateForm() {
        const errors = [];
        
        // Get form values
        const firstName = document.getElementById('editFirstName').value.trim();
        const lastName = document.getElementById('editLastName').value.trim();
        const username = document.getElementById('editUsername').value.trim();
        
        // Validate required fields
        if (!firstName) errors.push("First name is required");
        if (!lastName) errors.push("Last name is required");
        if (!username) errors.push("Username is required");
        
        // Validate field lengths
        if (firstName.length > 50) errors.push("First name must be 50 characters or less");
        if (document.getElementById('editMiddleName').value.trim().length > 50) {
            errors.push("Middle name must be 50 characters or less");
        }
        if (lastName.length > 50) errors.push("Last name must be 50 characters or less");
        if (username.length > 255) errors.push("Username must be 255 characters or less");
        
        return errors;
    }

    function saveProfileChanges() {
        const formErrors = document.getElementById('formErrors');
        const successMessage = document.getElementById('successMessage');
        const errorList = document.getElementById('errorList');
        const editProfileModal = document.getElementById('editProfileModal');
        
        // Validate form
        const errors = validateForm();
        
        if (errors.length > 0) {
            // Show errors
            if (errorList) errorList.innerHTML = errors.map(error => `<li>${error}</li>`).join('');
            if (formErrors) formErrors.classList.remove('hidden');
            if (successMessage) successMessage.classList.add('hidden');
            
            // Scroll to errors
            if (formErrors) formErrors.scrollIntoView({ behavior: 'smooth', block: 'center' });
            return;
        }
        
        // Get form values
        const firstName = document.getElementById('editFirstName').value.trim();
        const middleName = document.getElementById('editMiddleName').value.trim();
        const lastName = document.getElementById('editLastName').value.trim();
        const username = document.getElementById('editUsername').value.trim();
        
        // Update profile display (simulate backend update)
        document.getElementById('firstName').textContent = firstName;
        document.getElementById('middleName').textContent = middleName;
        document.getElementById('lastName').textContent = lastName;
        document.getElementById('usernameValue').textContent = username;
        document.getElementById('usernameDisplay').textContent = `@${username}`;
        
        // Update full name
        const fullName = `${firstName} ${middleName ? middleName + ' ' : ''}${lastName}`;
        document.getElementById('fullNameDisplay').textContent = fullName.trim();
        
        // Update timestamp to current time
        const now = new Date();
        const formattedTime = now.toISOString().replace('T', ' ').substring(0, 19);
        document.getElementById('updatedAt').textContent = formattedTime;
        
        // Show success message
        if (formErrors) formErrors.classList.add('hidden');
        if (successMessage) successMessage.classList.remove('hidden');
        
        // Update audit log (add new entry)
        const auditLogTable = document.querySelector('.table tbody');
        if (auditLogTable) {
            const newRow = document.createElement('tr');
            newRow.className = 'hover:bg-gray-50';
            newRow.innerHTML = `
                <td class="font-mono text-sm">${formattedTime}</td>
                <td>
                    <span class="badge badge-sm bg-blue-100 text-blue-800 border-0">PROFILE_UPDATE</span>
                </td>
                <td>Updated profile information</td>
            `;
            auditLogTable.insertBefore(newRow, auditLogTable.firstChild);
        }
        
        // Hide success message after 2 seconds and close modal
        setTimeout(() => {
            if (successMessage) successMessage.classList.add('hidden');
            if (editProfileModal) editProfileModal.close();
            
            // Show toast notification
            showToast('Profile updated successfully!', 'success');
        }, 2000);
    }

    function showToast(message, type = 'info') {
        // Remove existing toast if any
        const existingToast = document.querySelector('.toast');
        if (existingToast) {
            existingToast.remove();
        }
        
        // Create toast element
        const toast = document.createElement('div');
        toast.className = `toast fixed bottom-4 right-4 p-4 rounded-lg shadow-lg z-[9999] animate-fade-in ${
            type === 'success' ? 'bg-green-100 border border-green-300 text-green-800' : 
            type === 'error' ? 'bg-red-100 border border-red-300 text-red-800' : 
            'bg-blue-100 border border-blue-300 text-blue-800'
        }`;
        
        const icon = type === 'success' ? '✓' : type === 'error' ? '✗' : 'ℹ';
        
        toast.innerHTML = `
            <div class="flex items-center gap-3">
                <span class="font-bold">${icon}</span>
                <span>${message}</span>
            </div>
        `;
        
        document.body.appendChild(toast);
        
        // Remove toast after 5 seconds
        setTimeout(() => {
            toast.classList.add('animate-fade-out');
            setTimeout(() => toast.remove(), 300);
        }, 5000);
    }

    // Change Password Modal Functionality
        const changePasswordModal = document.getElementById('changePasswordModal');
        const passwordStep = document.getElementById('passwordStep');
        const otpStep = document.getElementById('otpStep');
        const successStep = document.getElementById('successStep');
        let otpTimer;
        let otpCountdown = 60; // 1 minute in seconds

        // Change Password Modal - Simplified Version
    let passwordChangeStep = 1;
    let passwordOTPTimer;
    let passwordOTPCountdown = 60;

    // Open Change Password Modal
    function openChangePasswordModal() {
        const modal = document.getElementById('changePasswordModal');
        if (!modal) return;
        
        // Reset to step 1
        showPasswordStep(1);
        
        // Clear form
        document.getElementById('currentPassword').value = '';
        document.getElementById('newPassword').value = '';
        document.getElementById('confirmPassword').value = '';
        
        // Set email for OTP display
        const email = document.getElementById('emailValue').textContent.trim();
        document.getElementById('otpEmailDisplay').textContent = email;
        
        // Reset errors
        document.getElementById('passwordMismatchError').classList.add('hidden');
        document.getElementById('passwordValidationError').classList.add('hidden');
        document.getElementById('otpError').classList.add('hidden');
        
        // Reset password checks
        resetPasswordChecks();
        
        // Generate OTP inputs
        generatePasswordOTPInputs();
        
        // Show modal
        modal.showModal();
    }

    // Show specific step for password change
    function showPasswordStep(step) {
        // Hide all steps
        document.getElementById('passwordStep').classList.add('hidden');
        document.getElementById('otpStep').classList.add('hidden');
        document.getElementById('successStep').classList.add('hidden');
        
        // Show selected step
        if (step === 1) {
            document.getElementById('passwordStep').classList.remove('hidden');
            passwordChangeStep = 1;
        } else if (step === 2) {
            document.getElementById('otpStep').classList.remove('hidden');
            passwordChangeStep = 2;
            startPasswordOTPTimer();
            document.getElementById('otp1').focus();
        } else if (step === 3) {
            document.getElementById('successStep').classList.remove('hidden');
            passwordChangeStep = 3;
        }
    }

    // Toggle password visibility
    function togglePasswordVisibility(fieldId) {
        const input = document.getElementById(fieldId);
        if (input.type === 'password') {
            input.type = 'text';
        } else {
            input.type = 'password';
        }
    }

    // Real-time password validation
    document.getElementById('newPassword').addEventListener('input', function(e) {
        const password = e.target.value;
        updatePasswordChecks(password);
    });

    function updatePasswordChecks(password) {
        // Length check
        const lengthCheck = document.getElementById('lengthCheck');
        lengthCheck.textContent = password.length >= 8 ? '✓' : '✗';
        lengthCheck.className = password.length >= 8 ? 'text-green-500' : 'text-red-500';
        
        // Uppercase check
        const uppercaseCheck = document.getElementById('uppercaseCheck');
        const hasUppercase = /[A-Z]/.test(password);
        uppercaseCheck.textContent = hasUppercase ? '✓' : '✗';
        uppercaseCheck.className = hasUppercase ? 'text-green-500' : 'text-red-500';
        
        // Number check
        const numberCheck = document.getElementById('numberCheck');
        const hasNumber = /[0-9]/.test(password);
        numberCheck.textContent = hasNumber ? '✓' : '✗';
        numberCheck.className = hasNumber ? 'text-green-500' : 'text-red-500';
        
        // Special character check
        const specialCheck = document.getElementById('specialCheck');
        const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(password);
        specialCheck.textContent = hasSpecial ? '✓' : '✗';
        specialCheck.className = hasSpecial ? 'text-green-500' : 'text-red-500';
    }

    function resetPasswordChecks() {
        const checks = ['lengthCheck', 'uppercaseCheck', 'numberCheck', 'specialCheck'];
        checks.forEach(id => {
            const element = document.getElementById(id);
            element.textContent = '✓';
            element.className = 'text-gray-400';
        });
    }

    // Validate password form
    function validatePasswordForm() {
        const currentPassword = document.getElementById('currentPassword').value;
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        
        // Hide previous errors
        document.getElementById('passwordMismatchError').classList.add('hidden');
        document.getElementById('passwordValidationError').classList.add('hidden');
        
        // Check if passwords match
        if (newPassword !== confirmPassword) {
            document.getElementById('passwordMismatchError').classList.remove('hidden');
            return;
        }
        
        // Check password strength
        const hasUppercase = /[A-Z]/.test(newPassword);
        const hasNumber = /[0-9]/.test(newPassword);
        const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(newPassword);
        
        if (newPassword.length < 8 || !hasUppercase || !hasNumber || !hasSpecial) {
            document.getElementById('passwordValidationError').classList.remove('hidden');
            document.getElementById('validationErrorMessage').textContent = 'Password does not meet all requirements';
            return;
        }
        
        // Check if new password is same as current
        if (newPassword === currentPassword) {
            document.getElementById('passwordValidationError').classList.remove('hidden');
            document.getElementById('validationErrorMessage').textContent = 'New password must be different from current password';
            return;
        }
        
        // All validations passed
        showPasswordStep(2);
    }

    // Generate OTP inputs for password change
    function generatePasswordOTPInputs() {
        const container = document.getElementById('otpInputs');
        container.innerHTML = '';
        
        for (let i = 1; i <= 6; i++) {
            const input = document.createElement('input');
            input.type = 'text';
            input.id = `otp${i}`;
            input.maxLength = 1;
            input.className = 'w-12 h-12 text-center text-xl font-bold border-2 border-gray-300 rounded-lg focus:border-[#991b1b] focus:ring-1 focus:ring-[#991b1b] outline-none';
            
            input.addEventListener('input', function(e) {
                if (e.target.value.length === 1 && i < 6) {
                    document.getElementById(`otp${i + 1}`).focus();
                }
                if (i === 6 && e.target.value.length === 1) {
                    verifyPasswordOTP();
                }
            });
            
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Backspace' && e.target.value.length === 0 && i > 1) {
                    document.getElementById(`otp${i - 1}`).focus();
                }
            });
            
            container.appendChild(input);
        }
    }

    // Start OTP timer for password change
    function startPasswordOTPTimer() {
        clearInterval(passwordOTPTimer);
        passwordOTPCountdown = 60;
        const resendBtn = document.getElementById('resendBtn');
        const countdownElement = document.getElementById('countdown');
        
        resendBtn.disabled = true;
        resendBtn.classList.add('text-gray-400', 'cursor-not-allowed');
        resendBtn.classList.remove('text-[#991b1b]', 'hover:text-red-700');
        
        passwordOTPTimer = setInterval(() => {
            passwordOTPCountdown--;
            
            const minutes = Math.floor(passwordOTPCountdown / 60);
            const seconds = passwordOTPCountdown % 60;
            countdownElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            if (passwordOTPCountdown <= 0) {
                clearInterval(passwordOTPTimer);
                resendBtn.disabled = false;
                resendBtn.classList.remove('text-gray-400', 'cursor-not-allowed');
                resendBtn.classList.add('text-[#991b1b]', 'hover:text-red-700');
                countdownElement.textContent = '00:00';
            }
        }, 1000);
    }

    // Resend OTP for password change
    function resendPasswordOTP() {
        const resendBtn = document.getElementById('resendBtn');
        resendBtn.innerHTML = 'Sending...';
        resendBtn.disabled = true;
        
        // Simulate API call
        setTimeout(() => {
            // Clear OTP inputs
            for (let i = 1; i <= 6; i++) {
                document.getElementById(`otp${i}`).value = '';
            }
            document.getElementById('otp1').focus();
            
            // Hide error
            document.getElementById('otpError').classList.add('hidden');
            
            // Restart timer
            startPasswordOTPTimer();
            
            // Reset button
            resendBtn.innerHTML = 'Resend OTP';
            
            // Show toast
            showToast('New OTP sent to your email', 'success');
        }, 1000);
    }

    // Verify OTP for password change
    function verifyPasswordOTP() {
        let otp = '';
        for (let i = 1; i <= 6; i++) {
            otp += document.getElementById(`otp${i}`).value;
        }
        
        if (otp.length !== 6) {
            document.getElementById('otpErrorMessage').textContent = 'Please enter all 6 digits';
            document.getElementById('otpError').classList.remove('hidden');
            return;
        }
        
        // For demo, accept any 6-digit OTP
        if (otp.length === 6 && /^\d+$/.test(otp)) {
            document.getElementById('otpError').classList.add('hidden');
            
            // Add audit log
            addPasswordChangeAuditLog();
            
            // Show success step
            showPasswordStep(3);
        } else {
            document.getElementById('otpErrorMessage').textContent = 'Invalid OTP code';
            document.getElementById('otpError').classList.remove('hidden');
        }
    }

    // Add audit log for password change
    function addPasswordChangeAuditLog() {
        const auditLogTable = document.querySelector('.table tbody');
        if (auditLogTable) {
            const now = new Date();
            const formattedTime = now.toISOString().replace('T', ' ').substring(0, 19);
            
            const newRow = document.createElement('tr');
            newRow.className = 'hover:bg-gray-50';
            newRow.innerHTML = `
                <td class="font-mono text-sm">${formattedTime}</td>
                <td>
                    <span class="badge badge-sm bg-yellow-100 text-yellow-800 border-0">PASSWORD_CHANGE</span>
                </td>
                <td>Password changed successfully</td>
            `;
            auditLogTable.insertBefore(newRow, auditLogTable.firstChild);
        }
    }

    // Complete password change
    function completePasswordChange() {
        const modal = document.getElementById('changePasswordModal');
        if (modal) {
            modal.close();
        }
        showToast('Password changed successfully!', 'success');
    }

    // Go back to password step
    function goToPasswordStep() {
        showPasswordStep(1);
    }

    // Initialize modal on page load
    document.addEventListener('DOMContentLoaded', function() {
        // Connect Change Password button
        const changePasswordBtn = document.querySelector('main button:last-child');
        if (changePasswordBtn && changePasswordBtn.textContent.includes('Change Password')) {
            changePasswordBtn.onclick = openChangePasswordModal;
        }
        
        // Generate OTP inputs
        generatePasswordOTPInputs();
    });    
    </script>

</body>
</html>